---
- id: snykio:maven:org.codehaus.plexus:plexus-archiver:31680
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[`org.codehaus.plexus:plexus-archiver`][1] is a Collection of Plexus\ncomponents
    to create archives or extract files out of an archive to a\ndirectory with a unified
    Archiver/UnArchiver API whatever the archive\nformat is.\n\nAffected versions
    of the package are vulnerable to Arbitrary File Write\nvia Archive Extraction
    (AKA \\\"Zip Slip\\\").\n\nIt is exploited using a specially crafted zip archive,
    that holds path\ntraversal filenames. When exploited, a filename in a malicious
    archive\nis concatenated to the target extraction directory, which results in
    the\nfinal path ending up outside of the target folder. For instance, a zip\nmay
    hold a file with a \\\"../../file.exe\\\" location and thus break out of\nthe
    target folder. If an executable or a configuration file is\noverwritten with a
    file containing malicious code, the problem can turn\ninto an arbitrary code execution
    issue quite easily.\n\nThe following is an example of a zip archive with one benign
    file and\none malicious file. Extracting the malicous file will result in\ntraversing
    out of the target folder, ending up in `/root/.ssh/`\noverwriting the `authorized_keys`
    file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n    \n    +2018-04-15
    22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n\n\n[1]: https://github.com/codehaus-plexus/plexus-archiver\n"
  affected_package: org.codehaus.plexus:plexus-archiver
  vulnerable_versions:
  - "< 3.6.0"
  severity: medium
  package_manager: maven
  cve:
  - CVE-2018-1002200
  cwe:
  - CWE-29
  disclosed_date: 2018-04-17
  created_date: 2018-05-31
  last_modified_date: 2018-05-31
  credit:
  - Snyk Security research Team
  references:
  - https://github.com/codehaus-plexus/plexus-archiver/commit/f8f4233508193b70df33759ae9dc6154d69c2ea8
  - https://github.com/codehaus-plexus/plexus-archiver/pull/87
  - https://github.com/snyk/zip-slip-vulnerability
  - https://snyk.io/research/zip-slip-vulnerability
  source_url: https://snyk.io/vuln/SNYK-JAVA-ORGCODEHAUSPLEXUS-31680
