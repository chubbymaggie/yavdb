---
- id: snykio:maven:com.h2database:h2:2018-04-12
  title: Arbitrary Code Execution
  description: |
    [com.h2database:h2][1] is a database engine.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution.

    It provides a web console for managing the database, and by default it
    does not have an password set. The `CREATE ALIAS` function calls a java
    code, allowing an attacker to execute arbitrary java code on projects
    running the h2 database.

        CREATE ALIAS REVERSE AS $$ String reverse(String s) { return new StringBuilder(s).reverse().toString(); } $$;
        CALL REVERSE('Test');



    [1]: http://www.h2database.com/html/main.html
    \n[com.h2database:h2][1] is a database engine.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution.

    It provides a web console for managing the database, and by default it
    does not have an password set. The `CREATE ALIAS` function calls a java
    code, allowing an attacker to execute arbitrary java code on projects
    running the h2 database.

        CREATE ALIAS REVERSE AS $$ String reverse(String s) { return new StringBuilder(s).reverse().toString(); } $$;
        CALL REVERSE('Test');



    [1]: http://www.h2database.com/html/main.html
    \n[com.h2database:h2][1] is a database engine.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution.

    It provides a web console for managing the database, and by default it
    does not have an password set. The `CREATE ALIAS` function calls a java
    code, allowing an attacker to execute arbitrary java code on projects
    running the h2 database.

        CREATE ALIAS REVERSE AS $$ String reverse(String s) { return new StringBuilder(s).reverse().toString(); } $$;
        CALL REVERSE('Test');



    [1]: http://www.h2database.com/html/main.html
    \n[com.h2database:h2][1] is a database engine.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution.

    It provides a web console for managing the database, and by default it
    does not have an password set. The `CREATE ALIAS` function calls a java
    code, allowing an attacker to execute arbitrary java code on projects
    running the h2 database.

        CREATE ALIAS REVERSE AS $$ String reverse(String s) { return new StringBuilder(s).reverse().toString(); } $$;
        CALL REVERSE('Test');



    [1]: http://www.h2database.com/html/main.html
    \n[com.h2database:h2][1] is a database engine.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution.

    It provides a web console for managing the database, and by default it
    does not have an password set. The `CREATE ALIAS` function calls a java
    code, allowing an attacker to execute arbitrary java code on projects
    running the h2 database.

        CREATE ALIAS REVERSE AS $$ String reverse(String s) { return new StringBuilder(s).reverse().toString(); } $$;
        CALL REVERSE('Test');



    [1]: http://www.h2database.com/html/main.html
  affected_package: com.h2database:h2
  vulnerable_versions:
  - "<= 1.4.197"
  severity: high
  package_manager: maven
  cve:
  - CVE-2018-10054
  cwe:
  - CWE-94
  credit:
  - Caio Vargas
  - Matheus Bernardes
  - Nubank
  references:
  - https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html
  - https://www.exploit-db.com/exploits/44422/
  source_url: https://snyk.io/vuln/SNYK-JAVA-COMH2DATABASE-31685
