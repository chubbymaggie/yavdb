---
- id: snykio:maven:org.apache.storm:storm-server:73624
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[org.apache.storm:storm-server][1] is a distributed realtime computation\nsystem.\n\nAffected
    versions of this package are vulnerable to Arbitrary File Write\nvia Archive Extraction
    (Zip Slip).\n\n\n\n[1]: https://github.com/apache/storm\n\\nIt is exploited using
    a specially crafted zip archive, that holds path\ntraversal filenames. When exploited,
    a filename in a malicious archive\nis concatenated to the target extraction directory,
    which results in the\nfinal path ending up outside of the target folder. For instance,
    a zip\nmay hold a file with a \\\"../../file.exe\\\" location and thus break out
    of\nthe target folder. If an executable or a configuration file is\noverwritten
    with a file containing malicious code, the problem can turn\ninto an arbitrary
    code execution issue quite easily.\n\nThe following is an example of a zip archive
    with one benign file and\none malicious file. Extracting the malicous file will
    result in\ntraversing out of the target folder, ending up in `/root/.ssh/`\noverwriting
    the `authorized_keys` file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n
    \   \n    +2018-04-15 22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n"
  affected_package: org.apache.storm:storm-server
  vulnerable_versions:
  - "< 2.0.0"
  severity: medium
  package_manager: maven
  cve:
  - CVE-2018-8008
  cwe:
  - CWE-29
  disclosed_date: 2018-05-04
  created_date: 2018-06-06
  last_modified_date: 2018-06-06
  credit:
  - Snyk Security research Team
  references:
  - https://github.com/apache/storm/commit/1117a37b01a1058897a34e11ff5156e465efb692
  - https://lists.apache.org/thread.html/613b2fca8bcd0a3b12c0b763ea8f7cf62e422e9f79fce6cfa5b08a58@%3Cdev.storm.apache.org%3E
  source_url: https://snyk.io/vuln/SNYK-JAVA-ORGAPACHESTORM-73624
