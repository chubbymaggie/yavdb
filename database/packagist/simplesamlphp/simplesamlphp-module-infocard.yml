---
- id: friendsofphp:packagist:simplesamlphp/simplesamlphp-module-infocard:CVE-2017-12874
  title: Incorrect signature verification
  affected_package: simplesamlphp/simplesamlphp-module-infocard
  vulnerable_versions:
  - "<1.0.1"
  package_manager: packagist
  cve:
  - CVE-2017-12874
  disclosed_date: 2016-12-03
  created_date: 2016-12-03
  last_modified_date: 2016-12-03
  credit:
  - FriendsOfPHP
  references:
  - https://simplesamlphp.org/security/201612-03
  source_url: https://github.com/FriendsOfPHP/security-advisories/blob/master/simplesamlphp/simplesamlphp-module-infocard/CVE-2017-12874.yaml
- id: snykio:packagist:simplesamlphp/simplesamlphp-module-infocard:70167
  title: Incorrect Signature Verification
  description: |
    Affected versions of [`simplesamlphp/simplesamlphp-module-infocard`][1]
    are vulnerable to Incorrect signature verification.

    > The InfoCard SimpleSAMLphp module allows incorporates a series of
    > libraries provided by the Zend Framework. As part of this third-party
    > library, the class Zend\_InfoCard\_Xml\_Security allows the
    > verification of the XML digital signature of XML chunks with a given
    > key. In particular, the validateXMLSignature() method receives an
    > string containing an XML document and a key to verify it, and throws
    > an exception in case there is any error, either caused by incorrect
    > input or an invalid signature. This method uses the openssl\_verify()
    > function provided by the openssl PHP extension.

    > The openssl\_verify() function returns 1 when the signature was
    > successfully verified, 0 if it failed to verify with the given key,
    > and -1 in case an error occurs. PHP allows translating numerical
    > values to boolean implicitly, with the following correspondences:

    * 0 equals false.
    * Non-zero equals true. This means that an implicit conversion to
      boolean of the values returned by openssl\_verify() will convert an
      error state, signaled by the value -1, to a successful verification of
      the signature (represented by the boolean true).

    > The aforementioned method was performing an implicit conversion to
    > boolean of the values returned by the openssl\_verify() function. This
    > means an error during signature verification is treated as a
    > successful verification by the method.



    [1]: https://packagist.org/packages/simplesamlphp/simplesamlphp-module-infocard
  affected_package: simplesamlphp/simplesamlphp-module-infocard
  vulnerable_versions:
  - "<1.0.1"
  severity: medium
  package_manager: packagist
  cwe:
  - CWE-345
  disclosed_date: 2016-12-03
  created_date: 2016-12-03
  last_modified_date: 2016-12-03
  credit:
  - Unknown
  references:
  - https://simplesamlphp.org/security/201612-03
  source_url: https://snyk.io/vuln/SNYK-PHP-SIMPLESAMLPHPSIMPLESAMLPHPMODULEINFOCARD-70167
