---
- id: friendsofphp:packagist:cartalyst/sentry:2016-10-04
  title: Null reset codes were allowed
  affected_package: cartalyst/sentry
  vulnerable_versions:
  - "<=2.1.6"
  package_manager: packagist
  credit:
  - FriendsOfPHP
  references:
  - https://haxx.ml/post/149975211631/how-i-hacked-your-cfp-and-probably-some-other
  source_url: https://github.com/FriendsOfPHP/security-advisories/blob/master/cartalyst/sentry/2016-09-05.yaml
- id: ossindex:packagist:cartalyst/sentry:2016-10-22
  title: Null reset codes were allowed
  description: Null reset codes were allowed
  affected_package: cartalyst/sentry
  vulnerable_versions:
  - "<2.1"
  package_manager: packagist
  credit:
  - OSSIndex
  references:
  - http://haxx.ml/post/149975211631/how-i-hacked-your-cfp-and-probably-some-other
  - https://github.com/FriendsOfPHP/security-advisories/blob/master/cartalyst/sentry/2016-09-05.yaml
  source_url: https://ossindex.net/resource/package/8397233873/vulnerabilities
- id: snykio:packagist:cartalyst/sentry:2016-10-04
  title: Insufficient Password Verification
  description: |
    Affected versions of [`cartalyst/sentry`][1] are vulnerable to
    Insufficient Password Verification. The schema for Eloquent-based users
    has `reset_password_code` set to `NULL` by default. The check for
    correct `$resetCode` simply does an equality comparison and returns true
    if there is a loose match.

    If an attacker is able to provide a null reset code to the package,
    there are no guards against arbitrary anonymous password resets. In many
    cases, submitting a url-encoded null byte value (`%00`) will match
    what\'s in the database, passing the check and allowing the attacker to
    set the password to what they wish.



    [1]: https://packagist.org/packages/cartalyst/sentry
    \nAffected versions of [`cartalyst/sentry`][1] are vulnerable to
    Insufficient Password Verification. The schema for Eloquent-based users
    has `reset_password_code` set to `NULL` by default. The check for
    correct `$resetCode` simply does an equality comparison and returns true
    if there is a loose match.

    If an attacker is able to provide a null reset code to the package,
    there are no guards against arbitrary anonymous password resets. In many
    cases, submitting a url-encoded null byte value (`%00`) will match
    what\'s in the database, passing the check and allowing the attacker to
    set the password to what they wish.



    [1]: https://packagist.org/packages/cartalyst/sentry
    \nAffected versions of [`cartalyst/sentry`][1] are vulnerable to
    Insufficient Password Verification. The schema for Eloquent-based users
    has `reset_password_code` set to `NULL` by default. The check for
    correct `$resetCode` simply does an equality comparison and returns true
    if there is a loose match.

    If an attacker is able to provide a null reset code to the package,
    there are no guards against arbitrary anonymous password resets. In many
    cases, submitting a url-encoded null byte value (`%00`) will match
    what\'s in the database, passing the check and allowing the attacker to
    set the password to what they wish.



    [1]: https://packagist.org/packages/cartalyst/sentry
  affected_package: cartalyst/sentry
  vulnerable_versions:
  - "<2.1.7"
  severity: high
  package_manager: packagist
  cwe:
  - CWE-264
  credit:
  - Unknown
  references:
  - https://github.com/cartalyst/sentry/pull/545
  - https://github.com/cartalyst/sentry/commit/c679730b8848686f59125cd821bf94946fb16a94
  source_url: https://snyk.io/vuln/SNYK-PHP-CARTALYSTSENTRY-70011
