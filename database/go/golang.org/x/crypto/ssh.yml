---
- id: snykio:go:golang.org/x/crypto/ssh:2017-03-30
  title: Man-in-the-Middle (MitM)
  description: |
    Affected versions of [`github.com/golang/crypto/ssh`][1] are vulnerable
    to Man-in-the-middle (MitM) attacks. The Go SSH library (x/crypto/ssh)
    by default does not verify host keys, facilitating man-in-the-middle
    attacks. Default behavior changed in commit [e4e2799][2] to require
    explicitly registering a hostkey verification mechanism.



    [1]: https://github.com/golang/crypto/tree/master/ssh
    [2]: https://github.com/golang/crypto/commit/e4e2799dd7aab89f583e1d898300d96367750991
    \nAffected versions of [`github.com/golang/crypto/ssh`][1] are vulnerable
    to Man-in-the-middle (MitM) attacks. The Go SSH library (x/crypto/ssh)
    by default does not verify host keys, facilitating man-in-the-middle
    attacks. Default behavior changed in commit [e4e2799][2] to require
    explicitly registering a hostkey verification mechanism.



    [1]: https://github.com/golang/crypto/tree/master/ssh
    [2]: https://github.com/golang/crypto/commit/e4e2799dd7aab89f583e1d898300d96367750991
  affected_package: golang.org/x/crypto/ssh
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: go
  cve:
  - CVE-2017-3204
  cwe:
  - CWE-320
  credit:
  - Phil Pennock
  references:
  - https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-3204
  - https://github.com/golang/crypto/commit/e4e2799dd7aab89f583e1d898300d96367750991
  - https://bridge.grumpy-troll.org/2017/04/golang-ssh-security/
  - https://github.com/golang/go/issues/19767
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GOLANGORGXCRYPTOSSH-50032
