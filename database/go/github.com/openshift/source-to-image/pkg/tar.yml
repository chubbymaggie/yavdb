---
- id: snykio:go:github.com/openshift/source-to-image/pkg/tar:CVE-2018-1103
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: |
    [`github.com/openshift/source-to-image/pkg/tar`][1] is a toolkit and
    workflow for building reproducible Docker images from source code.

    Affected versions of the package are vulnerable to Arbitrary File Write
    via Archive Extraction (AKA \"Zip Slip\").

    It can be exploited using a specially crafted zip archive, that holds
    path traversal filenames. When exploited, a filename in a malicious
    archive is concatenated to the target extraction directory, which
    results in the final path ending up outside of the target folder. For
    instance, a zip may hold a file with a `../../file.exe` location and
    thus break out of the target folder. If an executable or a configuration
    file is overwritten with a file containing malicious code, the problem
    can turn into an arbitrary code execution issue quite easily.

    The following is an example of a zip archive with one benign file and
    one malicious file. Extracting the malicous file will result in
    traversing out of the target folder, ending up in `/root/.ssh/`
    overwriting the `authorized_keys` file:

        ++2018-04-15 22:04:29 .....           19           19  good.txt
        ++2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys



    [1]: https://github.com/openshift/source-to-image/
  affected_package: github.com/openshift/source-to-image/pkg/tar
  vulnerable_versions:
  - "<1.1.10"
  severity: high
  package_manager: go
  cve:
  - CVE-2018-1103
  cwe:
  - CWE-22
  disclosed_date: 2018-03-28
  created_date: 2018-06-17
  last_modified_date: 2018-06-17
  credit:
  - Michael Hanselmann
  references:
  - https://hansmi.ch/articles/2018-04-openshift-s2i-security
  - https://github.com/openshift/source-to-image/pull/870
  - https://github.com/openshift/source-to-image/commit/f5cbcbc5cc6f8cc2f479a7302443bea407a700cb
  - https://snyk.io/research/zip-slip-vulnerability
  - https://github.com/snyk/zip-slip-vulnerability
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMOPENSHIFTSOURCETOIMAGEPKGTAR-50077
