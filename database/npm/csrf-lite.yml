---
- id: nodesecurity:npm:csrf-lite:2016-04-23
  title: Non-Constant Time String Comparison
  description: "Affected versions of `csrf-lite` are vulnerable to timing attacks
    as a result of testing CSRF tokens via a fail-early comparison instead of a constant-time
    comparison. \n\nTiming attacks remove the exponential increase in entropy gained
    from increased secret length, by providing per-character feedback on the correctness
    of a guess via miniscule timing differences.\n\nUnder favorable network conditions,
    an attacker can exploit this to guess the secret in no more than (16*18)288 guesses,
    instead of the 16^18 guesses required were the timing attack not present. "
  affected_package: csrf-lite
  vulnerable_versions:
  - "<=0.1.1"
  patched_versions:
  - ">=0.1.2"
  severity: medium
  package_manager: npm
  cvss_v3_vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
  credit:
  - Todd Wolfson
  references:
  - https://github.com/isaacs/csrf-lite/pull/1)
  source_url: https://nodesecurity.io/advisories/94
- id: snykio:npm:csrf-lite:2016-04-23
  title: Non-Constant Time String Comparison
  description: |
    [`csrf-lite`][1] is a CSRF protection utility for framework-free node
    sites. Affected versions of the package are vulnerable to a timing
    attack.

    While the CSRF protection itself works well and increases security, the
    library uses the built-in string comparison mechanism, `===`, and not a
    time constant string comparison. As a result, the comparison will fail
    faster when the first characters in the token are incorrect. An attacker
    can use this difference to perform a timing attack, essentially allowing
    them to guess the CSRF token one character at a time.

    You can read more about timing attacks in Node.js on the Snyk blog:
    [https://snyk.io/blog/node-js-timing-attack-ccc-ctf/][2]



    [1]: http://npmjs.com/package/csrf-lite
    [2]: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
    \n[`csrf-lite`][1] is a CSRF protection utility for framework-free node
    sites. Affected versions of the package are vulnerable to a timing
    attack.

    While the CSRF protection itself works well and increases security, the
    library uses the built-in string comparison mechanism, `===`, and not a
    time constant string comparison. As a result, the comparison will fail
    faster when the first characters in the token are incorrect. An attacker
    can use this difference to perform a timing attack, essentially allowing
    them to guess the CSRF token one character at a time.

    You can read more about timing attacks in Node.js on the Snyk blog:
    [https://snyk.io/blog/node-js-timing-attack-ccc-ctf/][2]



    [1]: http://npmjs.com/package/csrf-lite
    [2]: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
    \n[`csrf-lite`][1] is a CSRF protection utility for framework-free node
    sites. Affected versions of the package are vulnerable to a timing
    attack.

    While the CSRF protection itself works well and increases security, the
    library uses the built-in string comparison mechanism, `===`, and not a
    time constant string comparison. As a result, the comparison will fail
    faster when the first characters in the token are incorrect. An attacker
    can use this difference to perform a timing attack, essentially allowing
    them to guess the CSRF token one character at a time.

    You can read more about timing attacks in Node.js on the Snyk blog:
    [https://snyk.io/blog/node-js-timing-attack-ccc-ctf/][2]



    [1]: http://npmjs.com/package/csrf-lite
    [2]: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
    \n[`csrf-lite`][1] is a CSRF protection utility for framework-free node
    sites. Affected versions of the package are vulnerable to a timing
    attack.

    While the CSRF protection itself works well and increases security, the
    library uses the built-in string comparison mechanism, `===`, and not a
    time constant string comparison. As a result, the comparison will fail
    faster when the first characters in the token are incorrect. An attacker
    can use this difference to perform a timing attack, essentially allowing
    them to guess the CSRF token one character at a time.

    You can read more about timing attacks in Node.js on the Snyk blog:
    [https://snyk.io/blog/node-js-timing-attack-ccc-ctf/][2]



    [1]: http://npmjs.com/package/csrf-lite
    [2]: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
  affected_package: csrf-lite
  vulnerable_versions:
  - "<=0.1.1"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2016-10535
  cwe:
  - CWE-208
  credit:
  - Todd Wolfson
  references:
  - https://github.com/isaacs/csrf-lite/pull/1
  - https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
  source_url: https://snyk.io/vuln/npm:csrf-lite:20160423
