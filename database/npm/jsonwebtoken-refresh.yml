---
- id: ossindex:npm:jsonwebtoken-refresh:8269815006
  title: Verification Bypass
  description: |-
    There is a vulnerability in this module when the verification part is expecting a token digitally signed with an asymetric key (RS/ES family) of algorithms but instead the attacker send a token digitally signed with a symmetric algorithm (HS* family).

    The issue is because this library has the very same signature to verify both type of tokens (parameter: `secretOrPublicKey`).

    This change adds a new parameter to the verify called `algorithms`. This can be used to specify a list of supported algorithms, but the default value depends on the secret used: if the secretOrPublicKey contains the string `BEGIN CERTIFICATE` the default is `[ 'RS256','RS384','RS512','ES256','ES384','ES512' ]` otherwise is `[ 'HS256','HS384','HS512' ]`
  affected_package: jsonwebtoken-refresh
  vulnerable_versions:
  - "<4.2.2"
  package_manager: npm
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 2017-01-25
  credit:
  - OSSIndex
  references:
  - https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/
  - https://github.com/auth0/node-jsonwebtoken/commit/1bb584bc382295eeb7ee8c4452a673a77a68b687
  - https://nodesecurity.io/advisories/17
  - https://www.chosenplaintext.ca/2015/03/31/jwt-algorithm-confusion.html
  source_url: https://ossindex.net/resource/package/8399522260/vulnerabilities
