---
- id: ossindex:npm:express-restify-mongoose:2017-07-29
  title: Private Data Disclosure
  description: "> express-restify-mongoose is a module to easily create a flexible
    REST interface for mongoose models.\n> \n> -- [nodesecurity.io](https://nodesecurity.io/advisories/92)"
  affected_package: express-restify-mongoose
  vulnerable_versions:
  - "<=2.4.2 | >=3.0.0 <=3.0.1"
  package_manager: npm
  disclosed_date: 2017-07-29
  created_date: 2017-07-29
  last_modified_date: 2017-07-29
  credit:
  - OSSIndex
  references:
  - https://github.com/florianholzapfel/express-restify-mongoose/issues/252
  - https://nodesecurity.io/advisories/92
  source_url: https://ossindex.net/resource/package/7013568361/vulnerabilities
- id: snykio:npm:express-restify-mongoose:CVE-2016-10533
  title: Private Data Disclosure
  description: |+
    `express-restify-mongoose` is a module to easily create a flexible REST
    interface for mongoose models.

    It supports marking certain fields as private, to keep from exposing
    them to users, but fails to remove those fields from certain output
    scenarios, resulting in potential private data exposure.

    For instance, if you have the following User model:

        const User = mongoose.model('User', new mongoose.Schema({
            name: String,
            password: String,
        }));

    To keep from exposing the password, you\'ll likely to want to call it
    out as a private field like so:

        restify.serve(router, User, {
            private: ['password'],
        })

    This will indeed result in the password field not showing when you
    request an item, for instance via `GET /User` or `GET /User/some-id`.

    However, when querying on that field, using `GET
    /User?distinct=password`, ALL passwords for ALL the users in the DB
    would be shown.

  affected_package: express-restify-mongoose
  vulnerable_versions:
  - "< 2.5.0"
  - ">= 3.0.0 <3.1.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10533
  cwe:
  - CWE-200
  disclosed_date: 2016-04-19
  created_date: 2016-06-22
  last_modified_date: 2016-06-22
  credit:
  - Stefan Mirea
  references:
  - https://github.com/florianholzapfel/express-restify-mongoose/issues/252
  - https://github.com/florianholzapfel/express-restify-mongoose/pull/253
  source_url: https://snyk.io/vuln/npm:express-restify-mongoose:20160419
