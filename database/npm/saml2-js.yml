---
- id: nodesecurity:npm:saml2-js:2018-02-27
  title: Authentication bypass via incorrect XML canonicalization and DOM traversal
  description: |-
    Versions of `saml2-js` prior to 1.12.4 or 2.0.2 are vulnerable to authentication bypass.

    The `saml2-js` library may incorrectly utilize the results of XML DOM traversal and canonicalization APIs in such a way that an attacker may be able to manipulate the SAML data without invalidating the cryptographic signature, allowing the attack to potentially bypass authentication to SAML service providers.

    Security Assertion Markup Language (SAML) is an XML-based markup language for security assertions regarding authentication and permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in handling of comments within XML nodes. Incorrect use of these APIs by some SAML libraries results in incorrect parsing of the inner text of XML nodes such that any inner text after the comment is lost prior to cryptographically signing the SAML message. Text after the comment therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider without invalidating the cryptographic signature, which may allow attackers to bypass primary authentication for the affected SAML service provider
  affected_package: saml2-js
  vulnerable_versions:
  - "<= 1.12.3 || >= 2.0.0 <=2.0.1"
  patched_versions:
  - ">= 1.12.4 < 2.0.0 || >= 2.0.2"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2017-11429
  cvss_v3_vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
  credit:
  - Kelby Ludwig
  references:
  - https://www.kb.cert.org/vuls/id/475445
  source_url: https://nodesecurity.io/advisories/567
- id: snykio:npm:saml2-js:2018-02-27
  title: Authentication Bypass
  description: |+
    [`saml2-js`][1] is a node module that abstracts away the complexities of
    the SAML protocol behind an easy to use interface.

    Affected versions of this package are vulnerable to Authentication
    Bypass. It incorrectly utilizes the results of XML DOM traversal and
    canonicalization APIs in such a way that an attacker may be able to
    manipulate the SAML data without invalidating the cryptographic
    signature, allowing the attack to potentially bypass authentication to
    SAML service providers.



    [1]: https://www.npmjs.com/package/saml2-js
    \n[`saml2-js`][1] is a node module that abstracts away the complexities of
    the SAML protocol behind an easy to use interface.

    Affected versions of this package are vulnerable to Authentication
    Bypass. It incorrectly utilizes the results of XML DOM traversal and
    canonicalization APIs in such a way that an attacker may be able to
    manipulate the SAML data without invalidating the cryptographic
    signature, allowing the attack to potentially bypass authentication to
    SAML service providers.



    [1]: https://www.npmjs.com/package/saml2-js
    \n[`saml2-js`][1] is a node module that abstracts away the complexities of
    the SAML protocol behind an easy to use interface.

    Affected versions of this package are vulnerable to Authentication
    Bypass. It incorrectly utilizes the results of XML DOM traversal and
    canonicalization APIs in such a way that an attacker may be able to
    manipulate the SAML data without invalidating the cryptographic
    signature, allowing the attack to potentially bypass authentication to
    SAML service providers.



    [1]: https://www.npmjs.com/package/saml2-js
    \nSecurity Assertion Markup Language (SAML) is an XML-based markup
    language for security assertions regarding authentication and
    permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in
    handling of comments within XML nodes. Incorrect use of these APIs by
    some SAML libraries results in incorrect parsing of the inner text of
    XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment
    therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider
    without invalidating the cryptographic signature, which may allow
    attackers to bypass primary authentication for the affected SAML service
    provider.

    \nSecurity Assertion Markup Language (SAML) is an XML-based markup
    language for security assertions regarding authentication and
    permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in
    handling of comments within XML nodes. Incorrect use of these APIs by
    some SAML libraries results in incorrect parsing of the inner text of
    XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment
    therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider
    without invalidating the cryptographic signature, which may allow
    attackers to bypass primary authentication for the affected SAML service
    provider.

    \nSecurity Assertion Markup Language (SAML) is an XML-based markup
    language for security assertions regarding authentication and
    permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in
    handling of comments within XML nodes. Incorrect use of these APIs by
    some SAML libraries results in incorrect parsing of the inner text of
    XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment
    therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider
    without invalidating the cryptographic signature, which may allow
    attackers to bypass primary authentication for the affected SAML service
    provider.

    \nSecurity Assertion Markup Language (SAML) is an XML-based markup
    language for security assertions regarding authentication and
    permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in
    handling of comments within XML nodes. Incorrect use of these APIs by
    some SAML libraries results in incorrect parsing of the inner text of
    XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment
    therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider
    without invalidating the cryptographic signature, which may allow
    attackers to bypass primary authentication for the affected SAML service
    provider.

  affected_package: saml2-js
  vulnerable_versions:
  - "< 1.12.4 || >= 2.0.0 <2.0.2"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2017-11429
  cwe:
  - CWE-287
  credit:
  - Kelby Ludwig
  references:
  - https://duo.com/labs/psa/duo-psa-2017-003
  - https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations
  - https://www.kb.cert.org/vuls/id/475445
  source_url: https://snyk.io/vuln/npm:saml2-js:20180227
