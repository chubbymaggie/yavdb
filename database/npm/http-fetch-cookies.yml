---
- id: snykio:npm:http-fetch-cookies:20180502
  title: Malicious Package
  description: |+
    `http-fetch-cookies` contains a malicious backdoor.

    The backdoor works by parsing the user-supplied HTTP `request.headers`,
    looking for specifically formatted data that provides three different
    commands to the backdoor:

    * resetting the code buffer.
    * executing code located in the buffer by calling `vm.runInThisContext`,
      providing `module.exports`, `required`, `req`, `res`, and `next` as
      arguments.
    * loading remote code in to memory for execution.

    These control codes allowed for an attacker to input arbitrary code into
    a running server and execute it.

    The list of packages and their scripts are:

        express-cookies
        getcookies
        http-fetch-cookies

  affected_package: http-fetch-cookies
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-506
  disclosed_date: 2018-05-02
  created_date: 2018-05-03
  last_modified_date: 2018-05-03
  credit:
  - Unknown
  references:
  - https://blog.npmjs.org/post/173526807575/reported-malicious-module-getcookies
  - https://news.ycombinator.com/item?id=16975025
  source_url: https://snyk.io/vuln/npm:http-fetch-cookies:20180502
