---
- id: nodesecurity:npm:gm:2015-10-26
  title: Command Injection in gm.compare function
  description: Versions of `gm` prior to 1.21.1 are affected by a command injection
    vulnerability. The vulnerability is triggered when user input is passed into `gm.compare()`,
    which fails to sanitize input correctly before calling the graphics magic binary.
  affected_package: gm
  vulnerable_versions:
  - "<=1.20.0"
  patched_versions:
  - ">=1.21.1"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2015-7982
  cvss_v3_vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  credit:
  - Brendan Scarvell of Console
  references:
  - https://github.com/aheckmann/gm/commit/5f5c77490aa84ed313405c88905eb4566135be31)
  source_url: https://nodesecurity.io/advisories/54
- id: snykio:npm:gm:2015-10-26
  title: Remote Shell Command Injection
  description: |
    The [gm][1] package is the GraphicsMagick and ImageMagick wrapper for
    Node.js. The `compare()` function allows comparing of two images, taking
    as an input argument the path to both images. The function, in versions
    prior to 1.21.1, fails to sanitize the input correctly, making it
    vulnerable to a command injection attack.



    [1]: https://www.npmjs.com/package/gm
    \nThe [gm][1] package is the GraphicsMagick and ImageMagick wrapper for
    Node.js. The `compare()` function allows comparing of two images, taking
    as an input argument the path to both images. The function, in versions
    prior to 1.21.1, fails to sanitize the input correctly, making it
    vulnerable to a command injection attack.



    [1]: https://www.npmjs.com/package/gm
  affected_package: gm
  vulnerable_versions:
  - "<=1.20.0"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2015-7982
  cwe:
  - CWE-78
  credit:
  - Brendan Scarvell of Console
  references:
  - https://www.owasp.org/index.php/Command_Injection
  - https://github.com/aheckmann/gm/commit/5f5c77490aa84ed313405c88905eb4566135be31
  source_url: https://snyk.io/vuln/npm:gm:20151026
