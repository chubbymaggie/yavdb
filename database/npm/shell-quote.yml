---
- id: nodesecurity:npm:shell-quote:2016-06-21
  title: Potential Command Injection
  description: "Affected versions of `shell-quote` do not properly escape command
    line arguments, which may result in command injection if the library is used to
    escape user input destined for use as command line arguments.\n\n\n\n## Proof
    of Concept:\n\nThe following characters are not escaped properly: `>`,`;`,`{`,`}`\n\nBash
    has a neat but not well known feature known as \"Bash Brace Expansion\", wherein
    a sub-command can be executed without spaces by running it between a set of `{}`
    and using the `,` instead of ` ` to seperate arguments. Because of this, full
    command injection is possible even though it was initially thought to be impossible.
    \n\n```\n   const quote = require('shell-quote').quote;\n   console.log(quote(['a;{echo,test,123,234}']));\n
    \  // Actual                    \"a;{echo,test,123,234}\"\n   // Expected                  \"a\\;\\{echo,test,123,234\\}\"\n
    \  // Functional Equivalent     \"a; echo 'test' '123' '1234'\"\n```\n"
  affected_package: shell-quote
  vulnerable_versions:
  - "<=1.6.0"
  patched_versions:
  - ">=1.6.1"
  severity: high
  package_manager: npm
  cvss_v3_vector: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  credit:
  - Koki Takahashi, Node Security Team
  references:
  - ''
  source_url: https://nodesecurity.io/advisories/117
- id: snykio:npm:shell-quote:2016-06-21
  title: Command Injection
  description: |
    [`shell-quote`][1] is an npm package used to quote and parse shell
    commands. The `quote` function does not properly escape the following
    special characters `<`, `>`, `;`, `{`, `}` , and as a result can be used
    by an attacker to inject malicious shell commands or leak sensitive
    information.



    [1]: https://www.npmjs.com/package/shell-quote
    \n[`shell-quote`][1] is an npm package used to quote and parse shell
    commands. The `quote` function does not properly escape the following
    special characters `<`, `>`, `;`, `{`, `}` , and as a result can be used
    by an attacker to inject malicious shell commands or leak sensitive
    information.



    [1]: https://www.npmjs.com/package/shell-quote
  affected_package: shell-quote
  vulnerable_versions:
  - "<=1.6.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10541
  cwe:
  - CWE-78
  credit:
  - Koki Takahashi
  - Node Security Team
  references:
  - https://github.com/substack/node-shell-quote/compare/1.6.0...1.6.1
  source_url: https://snyk.io/vuln/npm:shell-quote:20160621
