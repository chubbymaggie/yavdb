---
- id: ossindex:npm:fernet:2016-10-12
  title: Possible Information Exposure Through Timing Discrepancy
  description: |-
    https://github.com/csquared/fernet.js/blob/7bc5801/lib/token.js#L64
    appears to be a short-circuit comparison. The spec requires the
    comparison to be done in constant time, independent of the
    contents of the inputs.

    The direct comparison that is used is vulnerable to a timing attack.
  affected_package: fernet
  vulnerable_versions:
  - "<0.1.0 >=0.0.1"
  package_manager: npm
  disclosed_date: 2016-10-12
  created_date: 2016-10-12
  last_modified_date: 2016-12-22
  credit:
  - OSSIndex
  references:
  - https://cwe.mitre.org/data/definitions/208.html
  - https://github.com/csquared/fernet.js/commit/29c456543c69604289931b4e8979ec17bbeeff33
  - https://github.com/csquared/fernet.js/commit/e99e6ae964289068fd620060a232f71b80f793a6#commitcomment-5577669
  - https://github.com/csquared/fernet.js/issues/1
  - https://github.com/csquared/fernet.js/pull/7
  - https://github.com/csquared/fernet.js/pull/8
  source_url: https://ossindex.net/resource/package/7013601290/vulnerabilities
- id: snykio:npm:fernet:20140306
  title: Timing Attack
  description: |
    [`fernet`][1] is a Javascript implementation of [Fernet symmetric
    encryption][2]. Affected versions of the package are vulnerable to a
    timing attack.

    The library implemented a character to character comparison, similar to
    the built-in string comparison mechanism, `===`, and not a time constant
    string comparison. As a result, the comparison will fail faster when the
    first characters in the HMAC are incorrect. An attacker can use this
    difference to perform a timing attack, essentially allowing them to
    guess the HMAC one character at a time.

    You can read more about timing attacks in Node.js on the [Snyk blog][3].



    [1]: https://www.npmjs.com/package/fernet
    [2]: https://github.com/kr/fernet-spec
    [3]: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/
  affected_package: fernet
  vulnerable_versions:
  - "<0.1.0 >=0.0.1"
  severity: medium
  package_manager: npm
  cwe:
  - CWE-208
  disclosed_date: 2014-03-06
  created_date: 2016-11-22
  last_modified_date: 2016-11-22
  credit:
  - Chris Continanza
  references:
  - https://github.com/csquared/fernet.js/pull/7
  - https://github.com/csquared/fernet.js/commit/29c456543c69604289931b4e8979ec17bbeeff33
  source_url: https://snyk.io/vuln/npm:fernet:20140306
