---
- id: nodesecurity:npm:windows-cpu:2017-05-19
  title: Command Execution
  description: |-
    Versions of `windows-cpu` before 0.1.5 will execute arbitrary code passed into the first argument of the `findLoad` method, resulting in remote code execution.

    ## Proof of Concept

    ```
    var win = require('windows-cpu');
    wind.findLoad('foo & calc.exe');
    ```
  affected_package: windows-cpu
  vulnerable_versions:
  - "< 0.1.5"
  patched_versions:
  - ">= 0.1.5"
  severity: high
  package_manager: npm
  cve:
  - CVE-2017-1000219
  cvss_v3_vector: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  credit:
  - Daniel Bond
  references:
  - https://github.com/KyleRoss/windows-cpu/blob/master/index.js#L81
  source_url: https://nodesecurity.io/advisories/336
- id: snykio:npm:windows-cpu:2017-05-19
  title: Arbitrary Command Execution
  description: |
    [`windows-cpu`][1] is a CPU monitoring utility for windows.

    Affected versions of this package are vulnerable to Arbitrary Command
    Execution via the `findLoad` method, which passes a user-inputed string
    to the shell without validation.

    Proof of Concept: This code will open the built-in calculator program.

        var win = require('windows-cpu');
        wind.findLoad('foo & calc.exe');



    [1]: https://www.npmjs.com/package/windows-cpu
    \n[`windows-cpu`][1] is a CPU monitoring utility for windows.

    Affected versions of this package are vulnerable to Arbitrary Command
    Execution via the `findLoad` method, which passes a user-inputed string
    to the shell without validation.

    Proof of Concept: This code will open the built-in calculator program.

        var win = require('windows-cpu');
        wind.findLoad('foo & calc.exe');



    [1]: https://www.npmjs.com/package/windows-cpu
    \n[`windows-cpu`][1] is a CPU monitoring utility for windows.

    Affected versions of this package are vulnerable to Arbitrary Command
    Execution via the `findLoad` method, which passes a user-inputed string
    to the shell without validation.

    Proof of Concept: This code will open the built-in calculator program.

        var win = require('windows-cpu');
        wind.findLoad('foo & calc.exe');



    [1]: https://www.npmjs.com/package/windows-cpu
    \n[`windows-cpu`][1] is a CPU monitoring utility for windows.

    Affected versions of this package are vulnerable to Arbitrary Command
    Execution via the `findLoad` method, which passes a user-inputed string
    to the shell without validation.

    Proof of Concept: This code will open the built-in calculator program.

        var win = require('windows-cpu');
        wind.findLoad('foo & calc.exe');



    [1]: https://www.npmjs.com/package/windows-cpu
    \n[`windows-cpu`][1] is a CPU monitoring utility for windows.

    Affected versions of this package are vulnerable to Arbitrary Command
    Execution via the `findLoad` method, which passes a user-inputed string
    to the shell without validation.

    Proof of Concept: This code will open the built-in calculator program.

        var win = require('windows-cpu');
        wind.findLoad('foo & calc.exe');



    [1]: https://www.npmjs.com/package/windows-cpu
  affected_package: windows-cpu
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2017-1000219
  cwe:
  - CWE-77
  credit:
  - Daniel Bond
  references:
  - https://github.com/KyleRoss/windows-cpu/blob/master/index.js#L81
  source_url: https://snyk.io/vuln/npm:windows-cpu:20170417
