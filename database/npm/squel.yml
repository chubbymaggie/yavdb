---
- id: nodesecurity:npm:squel:2018-04-21
  title: Failure to sanitize quotes which can lead to sql injection
  description: |-
    All versions of `squel` are vulnerable to sql injection.

    The `squel` package does not properly escape user provided input when provided using the `setFields` method. This could lead to sql injection if the query was then executed.

    Proof of concept demonstrating the injection of a single quote into a generated sql statement from user provided input.
    ```
    > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
    INSERT INTO buh (foo) VALUES ('bar'baz')
    ```
  affected_package: squel
  vulnerable_versions:
  - "<=99.999.99999"
  patched_versions:
  - "<0.0.0"
  severity: high
  package_manager: npm
  credit:
  - Sean Lynch
  references:
  - https://github.com/hiddentao/squel/issues/350)
  source_url: https://nodesecurity.io/advisories/575
- id: snykio:npm:squel:2018-03-22
  title: SQL Injection
  description: |
    [`squel`][1] is a SQL query string builder.

    Affected versions of this package are vulnerable to SQL Injection. It
    not properly escape user provided input when provided using the
    `setFields` method. This could lead to sql injection if the query was
    then executed.

    Proof of concept demonstrating the injection of a single quote into a
    generated sql statement from user provided input.

        > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
        INSERT INTO buh (foo) VALUES ('bar\'baz')



    [1]: https://www.npmjs.com/package/squel
    \n[`squel`][1] is a SQL query string builder.

    Affected versions of this package are vulnerable to SQL Injection. It
    not properly escape user provided input when provided using the
    `setFields` method. This could lead to sql injection if the query was
    then executed.

    Proof of concept demonstrating the injection of a single quote into a
    generated sql statement from user provided input.

        > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
        INSERT INTO buh (foo) VALUES ('bar\'baz')



    [1]: https://www.npmjs.com/package/squel
    \n[`squel`][1] is a SQL query string builder.

    Affected versions of this package are vulnerable to SQL Injection. It
    not properly escape user provided input when provided using the
    `setFields` method. This could lead to sql injection if the query was
    then executed.

    Proof of concept demonstrating the injection of a single quote into a
    generated sql statement from user provided input.

        > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
        INSERT INTO buh (foo) VALUES ('bar\'baz')



    [1]: https://www.npmjs.com/package/squel
    \n[`squel`][1] is a SQL query string builder.

    Affected versions of this package are vulnerable to SQL Injection. It
    not properly escape user provided input when provided using the
    `setFields` method. This could lead to sql injection if the query was
    then executed.

    Proof of concept demonstrating the injection of a single quote into a
    generated sql statement from user provided input.

        > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
        INSERT INTO buh (foo) VALUES ('bar\'baz')



    [1]: https://www.npmjs.com/package/squel
    \n[`squel`][1] is a SQL query string builder.

    Affected versions of this package are vulnerable to SQL Injection. It
    not properly escape user provided input when provided using the
    `setFields` method. This could lead to sql injection if the query was
    then executed.

    Proof of concept demonstrating the injection of a single quote into a
    generated sql statement from user provided input.

        > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
        INSERT INTO buh (foo) VALUES ('bar\'baz')



    [1]: https://www.npmjs.com/package/squel
  affected_package: squel
  vulnerable_versions:
  - "*"
  severity: medium
  package_manager: npm
  cwe:
  - CWE-89
  credit:
  - Sean Lynch
  references:
  - https://github.com/hiddentao/squel/issues/350
  source_url: https://snyk.io/vuln/npm:squel:20180322
