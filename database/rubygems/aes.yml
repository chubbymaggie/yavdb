---
- id: snykio:rubygems:aes:20286
  title: Insecure Encryption
  description: |
    [`aes`][1] is an AES encrypt/decrypt gem built on top of OpenSSL.
    Affected versions of this gem do not properly encrypt messages due to
    using the ruby `hex` function. `hex` converts hexadecimal strings into
    an integer and if it fails, zero is returned.

        '10'.hex  #=> 16
        'ff'.hex  #=> 255
        # zero is returned on error:
        'foobar'.hex  #=> 0

    Any string that doesn\'t have a hexadecimal sequence (e.g. `ff` or `13`)
    will be transformed into an array of 32 zeros, making it possible to
    decrypt messages with almost any key.



    [1]: https://rubygems.org/gems/aes
  affected_package: aes
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: rubygems
  cwe:
  - CWE-327
  disclosed_date: 2014-09-24
  created_date: 2017-02-07
  last_modified_date: 2017-02-07
  credit:
  - Kacper Walanus
  references:
  - https://blog.elpassion.com/simple-and-terrifying-encryption-story-c1f1d6707c07#.u8e279u80
  - https://gist.github.com/kv109/42289aa65f81e819910005f4773215a1
  - https://github.com/chicks/aes/issues/5
  - https://github.com/chicks/aes/pull/7
  source_url: https://snyk.io/vuln/SNYK-RUBY-AES-20286
