---
- id: snykio:rubygems:encryptor:20434
  title: Insecure Encryption
  description: |
    [`encryptor`][1] is a simple wrapper for the standard ruby OpenSSL
    library to encrypt and decrypt strings.

    Affected versions of the package are vulnerable to Insecure Encryption
    due to encrypting all messages using the same `key/nonce`. This exposed
    the `XOR` of the plaintexts and also leaked the `AES-GCM` authentication
    key, allowing an attacker to forge messages and potentially perform
    chosen ciphertext attacks.



    [1]: https://rubygems.org/gems/encryptor
  affected_package: encryptor
  vulnerable_versions:
  - "<3.0.0  >=2.0.0"
  severity: high
  package_manager: rubygems
  cwe:
  - CWE-327
  disclosed_date: 2016-03-19
  created_date: 2017-10-09
  last_modified_date: 2017-10-09
  credit:
  - Matouš Borák
  references:
  - https://github.com/attr-encrypted/encryptor/blob/master/CHANGELOG.md#300
  - https://github.com/attr-encrypted/encryptor/pull/22
  - https://github.com/attr-encrypted/encryptor/commit/b946c1806d620e452a8f88f94387a527c3da2715
  source_url: https://snyk.io/vuln/SNYK-RUBY-ENCRYPTOR-20434
