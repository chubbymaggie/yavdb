---
- id: rubyadvisory:rubygems:ruby-saml:CVE-
  title: Ruby-Saml Gem is vulnerable to entity expansion attacks
  description: 'ruby-saml before 1.0.0 is vulnerable to entity expansion attacks.

'
  affected_package: ruby-saml
  patched_versions:
  - ">= 1.0.0"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-
  osvdb: 124383
  cvss_v2_score: 3.9
  disclosed_date: 2015-06-30
  created_date: 2015-06-30
  last_modified_date: 2015-06-30
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://github.com/onelogin/ruby-saml/pull/247
- id: rubyadvisory:rubygems:ruby-saml:CVE-2016-5697
  title: XML signature wrapping attack
  description: |
    ruby-saml prior to version 1.3.0 is vulnerable to an XML signature wrapping attack
    in the specific scenario where there was a signature that referenced at the same time
    2 elements (but past the scheme validator process since 1 of the element was inside
    the encrypted assertion).

    ruby-saml users must update to 1.3.0, which implements 3 extra validations to
    mitigate this kind of attack.
  affected_package: ruby-saml
  patched_versions:
  - ">= 1.3.0"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2016-5697
  cvss_v2_score: 5.0
  cvss_v3_score: 7.5
  disclosed_date: 2016-06-24
  created_date: 2016-06-24
  last_modified_date: 2016-06-24
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://github.com/onelogin/ruby-saml/commit/a571f52171e6bfd87db59822d1d9e8c38fb3b995
- id: rubyadvisory:rubygems:ruby-saml:CVE-2017-11428
  title: Authentication bypass via incorrect XML canonicalization and DOM traversal
  description: |
    ruby-saml prior to version 1.7.0 is vulnerable to an authentication bypass via incorrect
    XML canonicalization and DOM traversal. Specifically, there are inconsistencies in
    handling of comments within XML nodes, resulting in incorrect parsing of the inner text
    of XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment therefore has no
    impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider without
    invalidating the cryptographic signature, which may allow attackers to bypass
    primary authentication for the affected SAML service provider.
  affected_package: ruby-saml
  patched_versions:
  - ">= 1.7.0"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2017-11428
  cvss_v2_score: 6.3
  disclosed_date: 2018-02-27
  created_date: 2018-02-27
  last_modified_date: 2018-02-27
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  - https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations
  - https://www.kb.cert.org/vuls/id/475445
  source_url: https://github.com/onelogin/ruby-saml/commit/048a544730930f86e46804387a6b6fad50d8176f
- id: snykio:rubygems:ruby-saml:20205
  title: Arbitrary Code Injection
  description: |
    [`ruby-saml`][1] is a SAML toolkit for Ruby on Rails.

    Affected versions contain a flaw that is triggered as the URI value of a
    SAML response is not properly sanitized through a prepared statement.
    This may allow a remote attacker to execute arbitrary shell commands on
    the host machine.



    [1]: https://rubygems.org/gems/ruby-saml
  affected_package: ruby-saml
  vulnerable_versions:
  - "< 0.8.2"
  severity: high
  package_manager: rubygems
  cwe:
  - CWE-94
  disclosed_date: 2015-02-02
  created_date: 2015-02-02
  last_modified_date: 2015-02-02
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/OSVDB-117903
  source_url: https://snyk.io/vuln/SNYK-RUBY-RUBYSAML-20205
- id: snykio:rubygems:ruby-saml:20217
  title: XPath Injection
  description: |
    [`ruby-saml`][1] is a SAML toolkit for Ruby on Rails.

    Affected versions are vulnerable to XPath injection on
    `xml_security.rb`. The lack of prepared statements allows for possible
    command injection, leading to arbitrary code execution.



    [1]: https://rubygems.org/gems/ruby-saml
  affected_package: ruby-saml
  vulnerable_versions:
  - "< 1.0.0"
  severity: medium
  package_manager: rubygems
  cwe:
  - CWE-91
  disclosed_date: 2015-04-28
  created_date: 2015-04-28
  last_modified_date: 2015-04-28
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/OSVDB-124991
  - https://github.com/onelogin/ruby-saml/pull/225
  source_url: https://snyk.io/vuln/SNYK-RUBY-RUBYSAML-20217
- id: snykio:rubygems:ruby-saml:20232
  title: XML External Entity (XXE) Injection
  description: |+
    [`ruby-saml`][1] is a SAML toolkit for Ruby on Rails.

    Affected versions of this gem are vulnerable to entity expansion
    attacks.



    [1]: https://rubygems.org/gems/ruby-saml
    \nXXE Injection is a type of attack against an application that parses XML
    input. XML is a markup language that defines a set of rules for encoding
    documents in a format that is both human-readable and machine-readable.
    By default, many XML processors allow specification of an external
    entity, a URI that is dereferenced and evaluated during XML processing.
    When an XML document is being parsed, the parser can make a request and
    include the content at the specified URI inside of the XML document.

    Attacks can include disclosing local files, which may contain sensitive
    data such as passwords or private user data, using file: schemes or
    relative paths in the system identifier.

    For example, below is a sample XML document, containing an XML element-
    username.

        <?xml version="1.0" encoding="ISO-8859-1"?>
           <username>John</username>
        </xml>

    An external XML entity - `xxe`, is defined using a system identifier and
    present within a DOCTYPE header. These entities can access local or
    remote content. For example the below code contains an external XML
    entity that would fetch the content of `/etc/passwd` and display it to
    the user rendered by `username`.

        <?xml version="1.0" encoding="ISO-8859-1"?>
        <!DOCTYPE foo [
           <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
           <username>&xxe;</username>
        </xml>

    Other XXE Injection attacks can access local resources that may not stop
    returning data, possibly impacting application availability and leading
    to Denial of Service.

  affected_package: ruby-saml
  vulnerable_versions:
  - "< 1.0.0"
  severity: medium
  package_manager: rubygems
  cwe:
  - CWE-611
  disclosed_date: 2015-06-29
  created_date: 2015-06-29
  last_modified_date: 2015-06-29
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/OSVDB-124383
  - https://github.com/onelogin/ruby-saml/pull/247
  source_url: https://snyk.io/vuln/SNYK-RUBY-RUBYSAML-20232
- id: snykio:rubygems:ruby-saml:CVE-2016-5697
  title: XML Signature Wrapping
  description: |
    [`ruby-saml`][1] is a SAML toolkit for Ruby on Rails.

    Affected versions of this gem are vulnerable to an XML signature
    wrapping attack. This occurs in the specific scenario where there was a
    signature that referenced at the same time 2 elements (but past the
    scheme validator process since 1 of the element was inside the encrypted
    assertion).



    [1]: https://rubygems.org/gems/ruby-saml
  affected_package: ruby-saml
  vulnerable_versions:
  - "< 1.3.0"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2016-5697
  cwe:
  - CWE-347
  disclosed_date: 2016-06-23
  created_date: 2016-06-23
  last_modified_date: 2016-06-23
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/CVE-2016-5697
  - https://github.com/onelogin/ruby-saml/commit/a571f52171e6bfd87db59822d1d9e8c38fb3b995
  source_url: https://snyk.io/vuln/SNYK-RUBY-RUBYSAML-20269
- id: snykio:rubygems:ruby-saml:CVE-2017-11428
  title: Authentication Bypass
  description: |+
    [`ruby-saml`][1] is a SAML toolkit for Ruby on Rails.

    Affected versions of this package are vulnerable to Authentication
    Bypass. It incorrectly utilizes the results of XML DOM traversal and
    canonicalization APIs in such a way that an attacker may be able to
    manipulate the SAML data without invalidating the cryptographic
    signature, allowing the attack to potentially bypass authentication to
    SAML service providers.



    [1]: https://rubygems.org/gems/ruby-saml
    \nSecurity Assertion Markup Language (SAML) is an XML-based markup
    language for security assertions regarding authentication and
    permissions, most commonly used for single sign-on (SSO) services.

    Some XML DOM traversal and canonicalization APIs may be inconsistent in
    handling of comments within XML nodes. Incorrect use of these APIs by
    some SAML libraries results in incorrect parsing of the inner text of
    XML nodes such that any inner text after the comment is lost prior to
    cryptographically signing the SAML message. Text after the comment
    therefore has no impact on the signature on the SAML message.

    A remote attacker can modify SAML content for a SAML service provider
    without invalidating the cryptographic signature, which may allow
    attackers to bypass primary authentication for the affected SAML service
    provider.

  affected_package: ruby-saml
  vulnerable_versions:
  - "<1.7.0"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2017-11428
  cwe:
  - CWE-287
  disclosed_date: 2018-02-27
  created_date: 2018-02-28
  last_modified_date: 2018-02-28
  credit:
  - Kelby Ludwig
  references:
  - https://duo.com/labs/psa/duo-psa-2017-003
  - https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations
  - https://www.kb.cert.org/vuls/id/475445
  - https://github.com/onelogin/ruby-saml/commit/048a544730930f86e46804387a6b6fad50d8176f
  source_url: https://snyk.io/vuln/SNYK-RUBY-RUBYSAML-22020
