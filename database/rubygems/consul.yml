---
- id: rubyadvisory:rubygems:consul:CVE-2019-16377
  title: 'Consul gem insufficient authentication check: Multiple powers in one controller
    are not always checked correctly

'
  description: |
    With the consul ruby gem before 1.0.3, if a controller checks multiple powers
    using `:if` or `:except` conditions, these conditions are erroneously applied
    to all power checks in that controller. This can lead to skipped power checks
    and hence unauthenticated access to certain controller actions.
  affected_package: consul
  patched_versions:
  - ">= 1.0.3"
  package_manager: rubygems
  cve:
  - CVE-2019-16377
  disclosed_date: 2019-09-23
  created_date: 2019-09-23
  last_modified_date: 2019-09-23
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://github.com/makandra/consul/issues/49
- id: snykio:rubygems:consul:468980
  title: Improper Access Control
  description: |
    [consul][1] is a scope-based authorization solution for Ruby on Rails.

    Affected versions of this package are vulnerable to Improper Access
    Control. When a controller has multiple power directives, the `:only`
    and `:except` options of the last directive is applied to all
    directives. This can lead to unauthenticated access to certain
    controller actions.



    [1]: https://github.com/makandra/consul
  affected_package: consul
  vulnerable_versions:
  - "<1.0.3"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2019-16377
  cwe:
  - CWE-284
  disclosed_date: 2019-09-23
  created_date: 2019-09-24
  last_modified_date: 2019-09-24
  credit:
  - Tobias Kraze
  references:
  - https://github.com/makandra/consul/issues/49
  - https://github.com/makandra/consul/pull/48
  source_url: https://snyk.io/vuln/SNYK-RUBY-CONSUL-468980
