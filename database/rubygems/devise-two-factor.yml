---
- id: rubyadvisory:rubygems:devise-two-factor:CVE-2015-7225
  title: 'devise-two-factor 1.1.0 and earlier vulnerable to replay attacks

'
  description: "A OTP replay vulnerability in devise-two-factor 1.1.0 and earlier
    allows local\nattackers to shoulder-surf a user's TOTP verification code and use
    it to\nlogin after the user has authenticated. \n\nBy not \"burning\" a previously
    used TOTP, devise-two-factor allows a narrow\nwindow of opportunity (aka the timestep
    period) where an attacker can re-use a\nverification code. \n\nShould an attacker
    possess a given user's authentication \ncredentials, this flaw effectively defeats
    two-factor authentication for the \nduration of the timestep. \n"
  affected_package: devise-two-factor
  patched_versions:
  - ">= 2.0.0"
  package_manager: rubygems
  cve:
  - CVE-2015-7225
  disclosed_date: 2015-09-17
  created_date: 2015-09-17
  last_modified_date: 2015-09-17
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://www.openwall.com/lists/oss-security/2015/09/06/2
- id: snykio:rubygems:devise-two-factor:CVE-2015-7225
  title: Time-Based One-Time Password (TOTP) Reuse
  description: |
    [`devise-two-factor`][1] is a two-factor authentication addition to
    [`devise`][2].

    Affected versions do not mark used TOTP (Time-Based One-Time Password)
    verification codes once used, and allow their reuse during the timestep
    period of the code. This can be exploited by an attacker with knowledge
    of the authentication credentials AND access to the TOTP verification
    code that was just used.



    [1]: https://rubygems.org/gems/devise-two-factor
    [2]: https://rubygems.org/gems/devise
  affected_package: devise-two-factor
  vulnerable_versions:
  - "< 2.0.0"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2015-7225
  cwe:
  - CWE-330
  disclosed_date: 2015-09-16
  created_date: 2015-09-16
  last_modified_date: 2015-09-16
  credit:
  - Viliam Holub
  references:
  - http://rubysec.com/advisories/CVE-2015-7225
  - http://www.openwall.com/lists/oss-security/2015/09/06/2
  source_url: https://snyk.io/vuln/SNYK-RUBY-DEVISETWOFACTOR-20239
