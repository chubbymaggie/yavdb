---
- id: rubyadvisory:rubygems:colorscore:CVE-2015-7541
  title: colorscore Gem for Ruby lib/colorscore/histogram.rb Arbitrary Command Injection
  description: |
    The contents of the `image_path`, `colors`, and `depth` variables generated
    from possibly user-supplied input are passed directly to the shell via
    `convert ...`.

    If a user supplies a value that includes shell metacharacters such as ';', an
    attacker may be able to execute shell commands on the remote system as the
    user id of the Ruby process.

    To resolve this issue, the aforementioned variables (especially `image_path`)
    must be sanitized for shell metacharacters.
  affected_package: colorscore
  patched_versions:
  - ">= 0.0.5"
  package_manager: rubygems
  cve:
  - CVE-2015-7541
  osvdb: 132516
  disclosed_date: 2016-01-04
  created_date: 2016-01-04
  last_modified_date: 2016-01-04
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://seclists.org/oss-sec/2016/q1/17
- id: snykio:rubygems:colorscore:20247
  title: Arbitrary Command Execution
  description: |
    [`colorscore`][1] finds the dominant colors in an image and scores them
    against a user-defined palette.

    The contents of the `image_path`, `colors`, and `depth` variables
    generated from possibly user-supplied input are passed directly to the
    shell via `convert ...`.

    If a user supplies a value that includes shell metacharacters such as
    `;`, an attacker may be able to execute shell commands on the remote
    system as the user id of the Ruby process.

    To resolve this issue, the aforementioned variables (especially
    `image_path`) must be sanitized for shell metacharacters.

          module Colorscore
            class Histogram
              def initialize(image_path, colors=16, depth=8)
                output = `convert #{image_path} -resize 400x400 -format %c -dither
        None -quantize YIQ -colors #{colors} -depth #{depth} histogram:info:-`
                @lines = output.lines.sort.reverse.map(&:strip).reject(&:empty?)
              end
    {: .language-ruby}



    [1]: https://rubygems.org/gems/colorscore
  affected_package: colorscore
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2015-7541
  cwe:
  - CWE-77
  disclosed_date: 2016-01-03
  created_date: 2016-01-03
  last_modified_date: 2016-01-03
  credit:
  - Dirk Zittersteyn
  references:
  - http://rubysec.com/advisories/CVE-2015-7541
  - http://seclists.org/oss-sec/2016/q1/17
  source_url: https://snyk.io/vuln/SNYK-RUBY-COLORSCORE-20247
