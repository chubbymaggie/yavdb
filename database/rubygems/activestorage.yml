---
- id: rubyadvisory:rubygems:activestorage:CVE-2018-16477
  title: Bypass vulnerability in Active Storage
  description: |
    There is a vulnerability in Active Storage. This vulnerability has been
    assigned the CVE identifier CVE-2018-16477.

    Versions Affected:  >= 5.2.0
    Not affected:       < 5.2.0
    Fixed Versions:     5.2.1.1

    Impact
    ------
    Signed download URLs generated by `ActiveStorage` for Google Cloud Storage
    service and Disk service include `content-disposition` and `content-type`
    parameters that an attacker can modify. This can be used to upload specially
    crafted HTML files and have them served and executed inline. Combined with
    other techniques such as cookie bombing and specially crafted AppCache manifests,
    an attacker can gain access to private signed URLs within a specific storage path.

    Vulnerable apps are those using either GCS or the Disk service in production.
    Other storage services such as S3 or Azure aren't affected.

    All users running an affected release should either upgrade or use one of the
    workarounds immediately. For those using GCS, it's also recommended to run the
    following to update existing blobs:

    ```
    ActiveStorage::Blob.find_each do |blob|
      blob.send :update_service_metadata
    end
    ```
  affected_package: activestorage
  unaffected_versions:
  - "< 5.2.0"
  patched_versions:
  - ">= 5.2.1.1"
  package_manager: rubygems
  cve:
  - CVE-2018-16477
  disclosed_date: 2018-11-27
  created_date: 2018-11-27
  last_modified_date: 2018-11-27
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://groups.google.com/forum/#!topic/rubyonrails-security/3KQRnXDIuLg
- id: snykio:rubygems:activestorage:72641
  title: Access Restriction Bypass
  description: |
    [activestorage][1] attaches cloud and local files in Rails applications.

    Affected versions o f this package are vulnerable to Access Restriction
    Bypass. Signed download URLs generated by `ActiveStorage` for Google
    Cloud Storage service and Disk service include `content-disposition` and
    `content-type` parameters that an attacker can modify. This can be used
    to upload specially crafted HTML files and have them served and executed
    inline.



    [1]: https://rubygems.org/gems/activestorage
  affected_package: activestorage
  vulnerable_versions:
  - "<5.2.1.1"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2018-16477
  cwe:
  - CWE-284
  disclosed_date: 2018-11-28
  created_date: 2018-11-28
  last_modified_date: 2018-11-28
  credit:
  - Unknown
  references:
  - https://groups.google.com/forum/%23%21topic/rubyonrails-security/3KQRnXDIuLg
  source_url: https://snyk.io/vuln/SNYK-RUBY-ACTIVESTORAGE-72641
